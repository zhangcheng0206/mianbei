<!DOCTYPE html>
<html>
		<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>新一代棉被-详情页</title>
		<link rel="stylesheet" href="css/iconfont.css" />
		<link rel="stylesheet" type="text/css" href="css/detail.css"/>

		<script type="text/javascript">
			var fs = document.documentElement.clientWidth / 750  * 100; 
			document.querySelector("html").style.fontSize = fs + "px";
		</script>
	</head>
	<body>
		<header>
			<a href="index.html "> <i class="iconfont icon-fanhui"> </i></a> 
			<span>新一代棉被加工行</span>
			
			<i class="iconfont icon-caidan" id="menu"> </i>
		</header>
		<section class="support">
			<div class="keys">
				<span>精制无网被</span>
				<span>加套有网被</span>
			</div>
			
		</section>
		
		<ul class="itemlist">
				<li class="item">
					<img style="width: 100%;"  src="img/1.jpg"/>
				</li>
				<li class="item">
					<img style="width: 100%;" src="img/2.jpg"/>
				</li>
				<li class="item">
					<img style="width: 100%;" src="img/3.jpg"/>
				</li>
				<li class="item">
					<img style="width: 100%;" src="img/6.jpg"/>
				</li>
				<li class="item">
					<img style="width: 100%;" src="img/7.jpg"/>
				</li>
				<li class="item">
					<img style="width: 100%;" src="img/8.jpg"/>
				</li>
			</ul>
		
		
		
		
		
		
		<script src="js/zepto/zepto.js"></script>
		
		<script src="js/zepto/event.js"></script>
		<script src="js/zepto/touch.js"></script>
		<script>
		
			window.requestAnimFrame = (function(){
				  return  window.requestAnimationFrame       ||
				          window.webkitRequestAnimationFrame ||
				          window.mozRequestAnimationFrame    ||
				          function( callback ){
				            window.setTimeout(callback, 1000 / 60);
				          };
			})();
			
			window.cancelrequestAnimFrame = (function(){
				  return  window.cancelAnimationFrame   ||
				          window.webkitCancelAnimationFrame ||
				          window.mozCancelAnimationFrame    ||
				          window.clearTimeout;
				          
			})();
			
			
		
			$(function(){
				//假设当前的进度值是 50
				var value = $(".pro-wrap").attr("data-proccess");
				
				var currentValue = 0;
				var step = value / 30;
				var timerId;
				
				//（1）红色的前景的宽度:从0 --- 整个宽度的一半       c3动画
				var totalWidth = $(".pro-wrap").width();
				var frontWidth = totalWidth * value/100 ; 
				$(".pro-front").css("width",   frontWidth);
	
				// （2） left从0  到  红色的前景的宽度 - 自己宽度/2  c3动画
				$(".pro-block").css("left", frontWidth - $(".pro-block").width()/2  );
				
				// (3)数字从0不断增加 到 value
				function  addNumber(){
					//currentV
					console.info("addNumber"); //1s 60次
					currentValue = currentValue + step;
					
					currentValue = currentValue.toFixed(2);//保留两位有效数字
					
					//Math.max();
					currentValue = currentValue > value ?  value : currentValue;
					
					$(".pro-block").html( currentValue + "%");
					
					timerId = requestAnimFrame(function(){
						addNumber();
					});
					
					if(currentValue >= value) {
						cancelrequestAnimFrame(timerId);
					}
				}
				
				addNumber();
			});
			
			
			$(function(){
			
				$("#menu").on("tap",function(){
					console.info("tap");
					
					$("#mask").toggle();
				})
			});
			
			
		</script>
	</body>
</html>
